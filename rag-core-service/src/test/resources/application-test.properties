# Test configuration for BYO RAG Core Service

# Database Configuration (H2 in-memory for testing)
spring.datasource.url=jdbc:h2:mem:testdb;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect

# Disable external services for tests
kafka.enabled=false
rag.embedding.service.url=http://localhost:8083
rag.document.service.url=http://localhost:8082

# Spring AI Configuration for tests
spring.ai.openai.api-key=test-api-key
spring.ai.openai.chat.model=gpt-3.5-turbo
spring.ai.openai.chat.options.temperature=0.7
spring.ai.openai.chat.options.max-tokens=1500

# Core Service Configuration
rag.core.cache.enabled=true
rag.core.cache.ttl=300
rag.core.max-context-tokens=4000
rag.core.max-retrieval-docs=10
rag.core.similarity-threshold=0.5
rag.core.conversation.enabled=true
rag.core.conversation.max-history=10
rag.core.streaming.enabled=false
rag.core.metrics.enabled=true

# Disable Feign for tests
spring.cloud.openfeign.client.config.embedding-service.url=http://mock-embedding-service
feign.client.config.default.connect-timeout=1000
feign.client.config.default.read-timeout=1000

# Security - disable for tests
spring.security.enabled=false
management.security.enabled=false

# Logging
logging.level.com.byo.rag.core=DEBUG
logging.level.org.springframework.ai=WARN
logging.level.feign=DEBUG
logging.level.org.springframework.web=INFO
# Disable Feign clients in tests
spring.cloud.openfeign.client.config.default.url=http://localhost:8083
feign.client.config.default.connectTimeout=1000
feign.client.config.default.readTimeout=1000


# Disable ChatModel auto-configuration in tests
spring.ai.openai.chat.enabled=false
spring.ai.ollama.chat.enabled=false
spring.autoconfigure.exclude=org.springframework.ai.autoconfigure.openai.OpenAiAutoConfiguration,org.springframework.ai.autoconfigure.ollama.OllamaAutoConfiguration